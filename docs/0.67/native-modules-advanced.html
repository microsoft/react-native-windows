<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Native Modules (Advanced) · React Native for Windows</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&gt;**This documentation and the underlying platform code is a work in progress.**"/><meta name="docsearch:version" content="0.67"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Native Modules (Advanced) · React Native for Windows"/><meta property="og:type" content="website"/><meta property="og:url" content="https://microsoft.github.io/react-native-windows/"/><meta property="og:description" content="&gt;**This documentation and the underlying platform code is a work in progress.**"/><meta property="og:image" content="https://microsoft.github.io/react-native-windows/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://microsoft.github.io/react-native-windows/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/react-native-windows/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-dark.min.css"/><link rel="stylesheet" href="/react-native-windows/css/code-block-buttons.css"/><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/focus-visible@5.0.2/dist/focus-visible.min.js"></script><script type="text/javascript" src="https://platform.twitter.com/widgets.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/react-native-windows/js/code-block-buttons.js"></script><script type="text/javascript" src="/react-native-windows/js/nav-buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/react-native-windows/js/scrollSpy.js"></script><link rel="stylesheet" href="/react-native-windows/css/prism.css"/><link rel="stylesheet" href="/react-native-windows/css/main.css"/><script src="/react-native-windows/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/react-native-windows/"><img class="logo" src="/react-native-windows/img/header_logo.svg" alt="React Native for Windows"/><h2 class="headerTitleWithLogo">React Native for Windows</h2></a><a href="/react-native-windows/versions"><h3>0.67</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/react-native-windows/docs/0.67/getting-started" target="_self">Docs</a></li><li class=""><a href="/react-native-windows/docs/0.67/flyout-component" target="_self">APIs</a></li><li class=""><a href="https://devblogs.microsoft.com/react-native/" target="_self">Blog</a></li><li class=""><a href="/react-native-windows/resources" target="_self">Resources</a></li><li class=""><a href="https://github.com/microsoft/react-native-windows-samples/tree/main/samples" target="_self">Samples</a></li><li class=""><a href="/react-native-windows/support" target="_self">Support</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Native Modules (Windows)</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">The Basics (Windows)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/getting-started">Get Started with Windows</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/rnw-dependencies">System Requirements</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/run-windows-cli">React Native Windows CLI</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/parity-status">API Parity</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/config">React Native Config Schema</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/windowsbrush-and-theme">Using PlatformColor and Responding to Themes</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/releases">Release Strategy</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/platform">Platform Detection</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/upgrade-app">Upgrading App to Latest Version of React Native Windows</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/setup-ci">Setup Continuous Integration Pipeline for an RNW App</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/app-publishing">Publishing a React Native Windows App to the Microsoft Store</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Native Modules (Windows)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/native-modules">Native Modules</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/view-managers">Native UI Components</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/native-modules-setup">Native Module Setup</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/native-modules-using">Using Community Native Modules</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/native-modules-autolinking">Autolinking Native Modules</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/react-native-windows/docs/0.67/native-modules-advanced">Native Modules (Advanced)</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/supported-community-modules">Supported Community Modules</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Native Development (Windows)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/native-code">Working with native code on Windows</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/native-code-language-choice">Choosing C++ or C# for native code</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/native-modules-marshalling-data">Marshaling Data</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/native-modules-async">Using Asynchronous Windows APIs</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/native-modules-jsvalue">Using JSValue</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/native-modules-csharp-codegen">Compile time code generation for C#</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/win10-vm">Developing Windows apps on a non-Windows PC</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/customizing-SDK-versions">Customizing SDK versions</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">The Basics (MacOS)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/rnm-getting-started">Get Started with macOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/rnm-dependencies">System Requirements</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Troubleshooting<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/debugging-javascript">JavaScript Debugging</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/native-modules-troubleshooting">Troubleshooting Native Modules</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/metro-config-out-tree-platforms">Metro config for out of tree platforms</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Experimental<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/hermes">Hermes on Windows + macOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/NuGet">Using react-native-windows NuGet packages</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/nuget-update">Updating NuGet packages</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.67/winui3">WinUI 3 Support in RNW</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/microsoft/react-native-windows-samples/blob/main/docs/native-modules-advanced.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Native Modules (Advanced)</h1></header><article><div><span><blockquote>
<p><strong>This documentation and the underlying platform code is a work in progress.</strong>
<strong>Examples (C# and C++/WinRT):</strong></p>
<ul>
<li><a href="https://github.com/microsoft/react-native-windows-samples/tree/main/samples-old/NativeModuleSample">Native Module Sample in <code>microsoft/react-native-windows-samples</code></a></li>
<li><a href="https://github.com/microsoft/react-native-windows/tree/main/packages/sample-apps">Sample App in <code>microsoft/react-native-windows/packages/microsoft-reactnative-sampleapps</code></a></li>
</ul>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="writing-native-modules-without-using-attributes-c"></a><a href="#writing-native-modules-without-using-attributes-c" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Writing Native Modules without using Attributes (C#)</h2>
<p>The <a href="/react-native-windows/docs/0.67/native-modules">Native Modules</a> page describes how you can author Native Modules in both C# and C++ using an attribute-based approach. The attribute-based approach makes it easy for you to author your native modules because it uses reflection to help React Native understand your native module.</p>
<p>In rare cases, you may need to write a native module against the ABI directly without using reflection. The high-level steps remain the same:</p>
<ol>
<li>Author your native module</li>
<li>Register your native module</li>
<li>Use your native module</li>
</ol>
<p>However, your app will be responsible for handling the code that the attributes would have otherwise provided. This guide will walk through those steps.</p>
<h3><a class="anchor" aria-hidden="true" id="1-authoring-your-native-module"></a><a href="#1-authoring-your-native-module" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Authoring your Native Module</h3>
<p>Here is the same <code>FancyMath</code> native module, but we do not use custom attributes and we're instead going to implement registration of its members ourselves without using reflection.</p>
<p><code>FancyMath.cs</code>:</p>
<pre><code class="hljs css language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>ReactNative<span class="token punctuation">.</span>Managed</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">NativeModuleSample</span>
<span class="token punctuation">{</span>
  <span class="token keyword">class</span> <span class="token class-name">FancyMath</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> E <span class="token operator">=</span> Math<span class="token punctuation">.</span>E<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> PI <span class="token operator">=</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">double</span></span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> a<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> b<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="2-registering-your-native-module"></a><a href="#2-registering-your-native-module" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Registering your Native Module</h3>
<p>Here's our <code>FancyMathPackageProvider</code> where we manually register our native module's members.</p>
<p><code>FancyMathPackageProvider.cs</code>:</p>
<pre><code class="hljs css language-csharp"><span class="token keyword">namespace</span> <span class="token namespace">NativeModuleSample</span>
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">sealed</span> <span class="token keyword">class</span> <span class="token class-name">FancyMathPackageProvider</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IReactPackageProvider</span></span>
  <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">CreatePackage</span><span class="token punctuation">(</span><span class="token class-name">IReactPackageBuilder</span> packageBuilder<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      packageBuilder<span class="token punctuation">.</span><span class="token function">AddModule</span><span class="token punctuation">(</span><span class="token string">"FancyMath"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">IReactModuleBuilder</span> moduleBuilder<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> module <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FancyMath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        moduleBuilder<span class="token punctuation">.</span><span class="token function">AddConstantProvider</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">IJSValueWriter</span> writer<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
          writer<span class="token punctuation">.</span><span class="token function">WritePropertyName</span><span class="token punctuation">(</span><span class="token string">"E"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          writer<span class="token punctuation">.</span><span class="token function">WriteDouble</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>E<span class="token punctuation">)</span><span class="token punctuation">;</span>
          writer<span class="token punctuation">.</span><span class="token function">WritePropertyName</span><span class="token punctuation">(</span><span class="token string">"Pi"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          writer<span class="token punctuation">.</span><span class="token function">WriteDouble</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>PI<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        moduleBuilder<span class="token punctuation">.</span><span class="token function">AddMethod</span><span class="token punctuation">(</span><span class="token string">"add"</span><span class="token punctuation">,</span> MethodReturnType<span class="token punctuation">.</span>Callback<span class="token punctuation">,</span>
          <span class="token punctuation">(</span><span class="token class-name">IJSValueReader</span> inputReader<span class="token punctuation">,</span>
          <span class="token class-name">IJSValueWriter</span> outputWriter<span class="token punctuation">,</span>
          <span class="token class-name">MethodResultCallback</span> resolve<span class="token punctuation">,</span>
          <span class="token class-name">MethodResultCallback</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">double</span></span> a <span class="token operator">=</span> inputReader<span class="token punctuation">.</span><span class="token function">GetNextArrayItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> inputReader<span class="token punctuation">.</span><span class="token function">GetDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Exception</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">double</span></span> b <span class="token operator">=</span> inputReader<span class="token punctuation">.</span><span class="token function">GetNextArrayItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> inputReader<span class="token punctuation">.</span><span class="token function">GetDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Exception</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">double</span></span> result <span class="token operator">=</span> module<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
            outputWriter<span class="token punctuation">.</span><span class="token function">WriteArrayBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            outputWriter<span class="token punctuation">.</span><span class="token function">WriteDouble</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
            outputWriter<span class="token punctuation">.</span><span class="token function">WriteArrayEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>outputWriter<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> module<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>As you can see, it is possible to use the API directly, but the code looks a little bit more complicated. You are responsible for creating your own constant provider, serializing each constant into the <code>IJSValueWriter</code>. For methods, you are also responsible for de-serializing arguments, calling your code, and then serializing any return values. There are some (de)serialization helper methods to make that a little bit simpler:</p>
<p><code>FancyMathPackageProvider.cs</code>:</p>
<pre><code class="hljs css language-csharp"><span class="token keyword">namespace</span> <span class="token namespace">NativeModuleSample</span>
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">sealed</span> <span class="token keyword">class</span> <span class="token class-name">FancyMathPackageProvider</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IReactPackageProvider</span></span>
  <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">CreatePackage</span><span class="token punctuation">(</span><span class="token class-name">IReactPackageBuilder</span> packageBuilder<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      packageBuilder<span class="token punctuation">.</span><span class="token function">AddModule</span><span class="token punctuation">(</span><span class="token string">"FancyMath"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">IReactModuleBuilder</span> moduleBuilder<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> module <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FancyMath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        moduleBuilder<span class="token punctuation">.</span><span class="token function">AddConstantProvider</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">IJSValueWriter</span> writer<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
          writer<span class="token punctuation">.</span><span class="token function">WriteProperty</span><span class="token punctuation">(</span><span class="token string">"E"</span><span class="token punctuation">,</span> module<span class="token punctuation">.</span>E<span class="token punctuation">)</span><span class="token punctuation">;</span>
          writer<span class="token punctuation">.</span><span class="token function">WriteProperty</span><span class="token punctuation">(</span><span class="token string">"Pi"</span><span class="token punctuation">,</span> module<span class="token punctuation">.</span>PI<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        moduleBuilder<span class="token punctuation">.</span><span class="token function">AddMethod</span><span class="token punctuation">(</span><span class="token string">"add"</span><span class="token punctuation">,</span> MethodReturnType<span class="token punctuation">.</span>Callback<span class="token punctuation">,</span>
          <span class="token punctuation">(</span><span class="token class-name">IJSValueReader</span> inputReader<span class="token punctuation">,</span>
          <span class="token class-name">IJSValueWriter</span> outputWriter<span class="token punctuation">,</span>
          <span class="token class-name">MethodResultCallback</span> resolve<span class="token punctuation">,</span>
          <span class="token class-name">MethodResultCallback</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">;</span>
            inputReader<span class="token punctuation">.</span><span class="token function">ReadArgs</span><span class="token punctuation">(</span><span class="token keyword">out</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">out</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">double</span></span> result <span class="token operator">=</span> module<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            outputWriter<span class="token punctuation">.</span><span class="token function">WriteArgs</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>outputWriter<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> module<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>It is possible to simplify the code even more by hiding the use of the value reader and writer interfaces:</p>
<p><code>FancyMathPackageProvider.cs</code>:</p>
<pre><code class="hljs css language-csharp"><span class="token keyword">namespace</span> <span class="token namespace">NativeModuleSample</span>
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">sealed</span> <span class="token keyword">class</span> <span class="token class-name">FancyMathPackageProvider</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IReactPackageProvider</span></span>
  <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">CreatePackage</span><span class="token punctuation">(</span><span class="token class-name">IReactPackageBuilder</span> packageBuilder<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      packageBuilder<span class="token punctuation">.</span><span class="token function">AddModule</span><span class="token punctuation">(</span><span class="token string">"FancyMath"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">IReactModuleBuilder</span> moduleBuilder<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> module <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FancyMath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        moduleBuilder<span class="token punctuation">.</span><span class="token function">AddConstantProvider</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">object</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span>
          <span class="token punctuation">[</span><span class="token string">"E"</span><span class="token punctuation">]</span> <span class="token operator">=</span> module<span class="token punctuation">.</span>E<span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token string">"Pi"</span><span class="token punctuation">]</span> <span class="token operator">=</span> module<span class="token punctuation">.</span>PI
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        moduleBuilder<span class="token punctuation">.</span><span class="token function">AddMethod</span><span class="token punctuation">(</span><span class="token string">"add"</span><span class="token punctuation">,</span> MethodReturnType<span class="token punctuation">.</span>Callback<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">MethodCallContext</span> callContext<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
          <span class="token class-name"><span class="token keyword">double</span></span> result <span class="token operator">=</span> module<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>callContext<span class="token punctuation">.</span>Args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>callContext<span class="token punctuation">.</span>Args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          callContext<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> module<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This code looks much better, but we are getting the overhead of boxing values that involves memory allocation for each call. The code generation that we do using LINQ Expression avoids this extra overhead. Though, the initial use of reflection and code generation has some penalty too.
From the maintenance point of view, the attributed code is much simple to support because we do not need to describe the same things in two different places.</p>
<p>And as for the rest of the code, once we have the <code>IReactPackageProvider</code>, registering that package is the same as in the example above that uses custom attributes.</p>
<h3><a class="anchor" aria-hidden="true" id="3-using-your-native-module-in-js"></a><a href="#3-using-your-native-module-in-js" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Using your Native Module in JS</h3>
<p>Using your native module in JS is the exact same as if the native module was defined using attributes.</p>
<p><code>NativeModuleSample.js</code>:</p>
<pre><code class="hljs css language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  AppRegistry<span class="token punctuation">,</span>
  Alert<span class="token punctuation">,</span>
  NativeModules<span class="token punctuation">,</span>
  Text<span class="token punctuation">,</span>
  View<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-native'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">NativeModuleSample</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">_onPressHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    NativeModules<span class="token punctuation">.</span>FancyMath<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
      <span class="token comment">/* arg a */</span> NativeModules<span class="token punctuation">.</span>FancyMath<span class="token punctuation">.</span>Pi<span class="token punctuation">,</span>
      <span class="token comment">/* arg b */</span> NativeModules<span class="token punctuation">.</span>FancyMath<span class="token punctuation">.</span><span class="token constant">E</span><span class="token punctuation">,</span>
      <span class="token comment">/* callback */</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Alert<span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span>
          <span class="token string">'FancyMath'</span><span class="token punctuation">,</span>
          <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">FancyMath says </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>NativeModules<span class="token punctuation">.</span>FancyMath<span class="token punctuation">.</span>Pi<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>NativeModules<span class="token punctuation">.</span>FancyMath<span class="token punctuation">.</span><span class="token constant">E</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'OK'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span><span class="token literal-property property">cancelable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">View</span></span><span class="token punctuation">></span></span><span class="token plain-text">
         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Text</span></span><span class="token punctuation">></span></span><span class="token plain-text">FancyMath says PI = </span><span class="token punctuation">{</span>NativeModules<span class="token punctuation">.</span>FancyMath<span class="token punctuation">.</span>Pi<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Text</span></span><span class="token punctuation">></span></span><span class="token plain-text">
         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Text</span></span><span class="token punctuation">></span></span><span class="token plain-text">FancyMath says E = </span><span class="token punctuation">{</span>NativeModules<span class="token punctuation">.</span>FancyMath<span class="token punctuation">.</span><span class="token constant">E</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Text</span></span><span class="token punctuation">></span></span><span class="token plain-text">
         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">onPress</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>_onPressHandler<span class="token punctuation">}</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Click me!<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">View</span></span><span class="token punctuation">></span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

AppRegistry<span class="token punctuation">.</span><span class="token function">registerComponent</span><span class="token punctuation">(</span><span class="token string">'NativeModuleSample'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> NativeModuleSample<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="native-modules-with-custom-event-emitters"></a><a href="#native-modules-with-custom-event-emitters" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Native Modules with Custom Event Emitters</h2>
<p>By default, native modules share a common <code>RCTDeviceEventEmitter</code> which emits the actual events into JavaScript. However, that comes with the limitation that all of the native modules must have globally unique event names. If you wanted to ensure that your event names didn't collide with other events from other native modules, you could create your own <code>EventEmitter</code>.</p>
<p>So say we have our <code>FancyMath</code> module, where we've specified <code>&quot;MathEmitter&quot;</code> as the name of the <code>EventEmitter</code>:</p>
<p><code>FancyMath.cs</code>:</p>
<pre><code class="hljs css language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>ReactNative<span class="token punctuation">.</span>Managed</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">NativeModuleSample</span>
<span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactModule</span><span class="token attribute-arguments"><span class="token punctuation">(</span>EventEmitterName <span class="token operator">=</span> <span class="token string">"MathEmitter"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
  <span class="token keyword">class</span> <span class="token class-name">FancyMath</span>
  <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactConstant</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> E <span class="token operator">=</span> Math<span class="token punctuation">.</span>E<span class="token punctuation">;</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactConstant</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Pi"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> PI <span class="token operator">=</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">;</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactMethod</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"add"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">double</span></span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> a<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> b<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">double</span></span> result <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token function">AddEvent</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactEvent</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">ReactEvent<span class="token punctuation">&lt;</span><span class="token keyword">double</span><span class="token punctuation">></span></span> AddEvent <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Now, when the native code calls <code>AddEvent</code>, that will be essentially translated into a JS call of <code>MathEmitter.emit(&quot;AddEvent&quot;, result)</code>.</p>
<p>So in order for this to work, you will need to create and register a <code>MathEmitter</code> module. You can create the module by and you can use the existing <code>EventEmitter</code> class.</p>
<p><code>MathEmitter.js</code>:</p>
<pre><code class="hljs css language-js"><span class="token keyword">const</span> EventEmitter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"EventEmitter"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> BatchedBridge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"BatchedBridge"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

BatchedBridge<span class="token punctuation">.</span><span class="token function">registerLazyCallableModule</span><span class="token punctuation">(</span><span class="token string">"MathEmitter"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="c-native-modules-with-initializer-and-as-a-way-to-access-reactcontext"></a><a href="#c-native-modules-with-initializer-and-as-a-way-to-access-reactcontext" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>C# Native Modules with Initializer and as a way to access <code>ReactContext</code></h2>
<p>If your native module needs to perform some initialization logic on the native (C#) side, there is an easy mechanism for you to do so when the app is setting up. All you need to do is add a method that takes a <a href="IReactContext"><code>ReactContext</code></a> and has <code>[ReactInitializer]</code> attribute.
If your native module needs to perform some operation periodically, you can do so by setting up a timer during your module's initialization as in the following example:</p>
<pre><code class="hljs css language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactModule</span></span><span class="token punctuation">]</span>
<span class="token keyword">internal</span> <span class="token keyword">sealed</span> <span class="token keyword">class</span> <span class="token class-name">NativeModuleSample</span>
<span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">ThreadPoolTimer</span> m_timer<span class="token punctuation">;</span>

  <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactInitializer</span></span><span class="token punctuation">]</span>
  <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Initialize</span><span class="token punctuation">(</span><span class="token class-name">ReactContext</span> reactContext<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    m_timer <span class="token operator">=</span> ThreadPoolTimer<span class="token punctuation">.</span><span class="token function">CreatePeriodicTimer</span><span class="token punctuation">(</span>
      <span class="token keyword">new</span> <span class="token constructor-invocation class-name">TimerElapsedHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token operator">=></span>
      <span class="token punctuation">{</span>
          <span class="token comment">// Do something every 5 seconds</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token operator">~</span><span class="token function">NativeModuleSample</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    _timer<span class="token punctuation">?.</span><span class="token function">Cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>If your module needs access to the <a href="IReactContext"><code>ReactContext</code></a> context or <a href="ReactNativeHost"><code>ReactNativeHost</code></a>, you can hold on to the context passed onto the method that is marked <code>[ReactInitializer]</code>.</p>
<pre><code class="hljs css language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactModule</span></span><span class="token punctuation">]</span>
<span class="token keyword">internal</span> <span class="token keyword">sealed</span> <span class="token keyword">class</span> <span class="token class-name">NativeModuleSample</span>
<span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">ReactContext</span> m_reactContext<span class="token punctuation">;</span>

  <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactInitializer</span></span><span class="token punctuation">]</span>
  <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Initialize</span><span class="token punctuation">(</span><span class="token class-name">ReactContext</span> reactContext<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    m_reactContext <span class="token operator">=</span> reactContext<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactMethod</span></span><span class="token punctuation">]</span>
  <span class="token keyword">public</span> <span class="token return-type class-name">Task</span> <span class="token function">SampleAccessToHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> reactNativeHost <span class="token operator">=</span> ReactNativeHost<span class="token punctuation">.</span><span class="token function">FromContext</span><span class="token punctuation">(</span>m_reactContext<span class="token punctuation">.</span>Handle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Use debugging api that reloads the instance</span>
    reactNativeHost<span class="token punctuation">.</span><span class="token function">ReloadInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactMethod</span></span><span class="token punctuation">]</span>
  <span class="token keyword">public</span> <span class="token return-type class-name">Task</span> <span class="token function">EmitRCTDeviceEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    m_reactContext<span class="token punctuation">.</span><span class="token function">EmitJSEvent</span><span class="token punctuation">(</span><span class="token string">"RCTDeviceEventEmitter"</span><span class="token punctuation">,</span> <span class="token string">"MyCustomJsEvent"</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<hr />
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 7/10/2025</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/react-native-windows/docs/0.67/native-modules-autolinking"><span class="arrow-prev">← </span><span>Autolinking Native Modules</span></a><a class="docs-next button" href="/react-native-windows/docs/0.67/supported-community-modules"><span>Supported Community Modules</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#writing-native-modules-without-using-attributes-c">Writing Native Modules without using Attributes (C#)</a><ul class="toc-headings"><li><a href="#1-authoring-your-native-module">1. Authoring your Native Module</a></li><li><a href="#2-registering-your-native-module">2. Registering your Native Module</a></li><li><a href="#3-using-your-native-module-in-js">3. Using your Native Module in JS</a></li></ul></li><li><a href="#native-modules-with-custom-event-emitters">Native Modules with Custom Event Emitters</a></li><li><a href="#c-native-modules-with-initializer-and-as-a-way-to-access-reactcontext">C# Native Modules with Initializer and as a way to access <code>ReactContext</code></a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><div><h5>React Native Docs</h5><a href="https://reactnative.dev/docs/getting-started">Getting Started</a><a href="https://reactnative.dev/docs/tutorial">Tutorial</a><a href="https://reactnative.dev/docs/components-and-apis">Components and APIs</a><a href="https://reactnative.dev/docs/more-resources">More Resources</a></div><div><h5>React Native for Windows Docs</h5><div style="color:white;font-weight:500;font-size:16px"><a href="/react-native-windows/docs/getting-started">Get Started with Windows</a></div><a href="/react-native-windows/docs/parity-status">React Native Windows Components and APIs</a><a href="/react-native-windows/docs/native-modules">Native Modules</a><a href="/react-native-windows/docs/view-managers">Native UI Components</a></div><div><h5>Connect With Us On</h5><a href="https://devblogs.microsoft.com/react-native/">Blog</a><a href="https://twitter.com/ReactNativeMSFT" target="_blank">Twitter</a><a href="https://github.com/microsoft/react-native-windows" target="_blank">GitHub</a><a href="https://github.com/microsoft/react-native-windows-samples/tree/main/samples" target="_blank">Samples</a></div></section></footer></div></body></html>