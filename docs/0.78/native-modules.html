<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Native Modules · React Native for Windows</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&gt; **This documentation and the underlying platform code is a work in progress.**"/><meta name="docsearch:version" content="0.78"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Native Modules · React Native for Windows"/><meta property="og:type" content="website"/><meta property="og:url" content="https://microsoft.github.io/react-native-windows/"/><meta property="og:description" content="&gt; **This documentation and the underlying platform code is a work in progress.**"/><meta property="og:image" content="https://microsoft.github.io/react-native-windows/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://microsoft.github.io/react-native-windows/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/react-native-windows/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-dark.min.css"/><link rel="stylesheet" href="/react-native-windows/css/code-block-buttons.css"/><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/focus-visible@5.0.2/dist/focus-visible.min.js"></script><script type="text/javascript" src="https://platform.twitter.com/widgets.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/react-native-windows/js/code-block-buttons.js"></script><script type="text/javascript" src="/react-native-windows/js/nav-buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/react-native-windows/js/scrollSpy.js"></script><link rel="stylesheet" href="/react-native-windows/css/prism.css"/><link rel="stylesheet" href="/react-native-windows/css/main.css"/><script src="/react-native-windows/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/react-native-windows/"><img class="logo" src="/react-native-windows/img/header_logo.svg" alt="React Native for Windows"/><h2 class="headerTitleWithLogo">React Native for Windows</h2></a><a href="/react-native-windows/versions"><h3>0.78</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/react-native-windows/docs/0.78/getting-started" target="_self">Docs</a></li><li class=""><a href="/react-native-windows/docs/0.78/flyout-component" target="_self">APIs</a></li><li class=""><a href="https://devblogs.microsoft.com/react-native/" target="_self">Blog</a></li><li class=""><a href="/react-native-windows/resources" target="_self">Resources</a></li><li class=""><a href="https://github.com/microsoft/react-native-windows-samples/tree/main/samples" target="_self">Samples</a></li><li class=""><a href="/react-native-windows/support" target="_self">Support</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Native Modules (Windows)</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">The Basics (Windows)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/getting-started">Get Started with Windows</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/rnw-dependencies">System Requirements</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/react-native-windows-cli">React Native Windows CLI</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/parity-status">API Parity</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/config">React Native Config Schema</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/windowsbrush-and-theme">Using PlatformColor and Responding to Themes</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/releases">Release Strategy</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/platform">Platform Detection</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/upgrade-app">Upgrading App to Latest Version of React Native Windows</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/setup-ci">Setup Continuous Integration Pipeline for an RNW App</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/app-publishing">Publishing a React Native Windows App to the Microsoft Store</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">CLI Commands (Windows)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/autolink-windows-cli">react-native autolink-windows</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/codegen-windows-cli">react-native codegen-windows</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/init-windows-cli">react-native init-windows</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/run-windows-cli">react-native run-windows</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Native Modules (Windows)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem navListItemActive"><a class="navItem" href="/react-native-windows/docs/0.78/native-modules">Native Modules</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/view-managers">Native UI Components</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/native-modules-setup">Native Module Setup</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/native-modules-vs-turbo-modules">Native Modules vs Turbo Modules</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/native-modules-using">Using Community Native Modules</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/native-modules-autolinking">Autolinking Native Modules</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/native-modules-advanced">Native Modules (Advanced)</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/supported-community-modules">Supported Community Modules</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Native Development (Windows)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/native-code">Working with native code on Windows</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/native-code-language-choice">Choosing C++ or C# for native code</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/native-modules-marshalling-data">Marshaling Data</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/native-modules-async">Using Asynchronous Windows APIs</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/native-modules-jsvalue">Using JSValue</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/native-modules-csharp-codegen">Compile time code generation for C#</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/win10-vm">Developing Windows apps on a non-Windows PC</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/customizing-SDK-versions">Customizing SDK versions</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/managing-cpp-deps">Managing C++ dependencies</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">The Basics (MacOS)<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/rnm-getting-started">Get Started with macOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/rnm-dependencies">System Requirements</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Troubleshooting<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/debugging-javascript">JavaScript Debugging</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/native-modules-troubleshooting">Troubleshooting Native Modules</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/metro-config-out-tree-platforms">Metro config for out of tree platforms</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Experimental<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/new-architecture">New vs. Old Architecture</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/hermes">Hermes on Windows + macOS</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/docs/0.78/NuGet">Using Microsoft.ReactNative NuGet packages</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/microsoft/react-native-windows-samples/blob/main/docs/native-modules.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Native Modules</h1></header><article><div><span><blockquote>
<p><strong>This documentation and the underlying platform code is a work in progress.</strong>
<strong>Examples (C# and C++/WinRT):</strong></p>
<ul>
<li><a href="https://github.com/microsoft/react-native-windows-samples/tree/main/samples-old/NativeModuleSample">Native Module Sample in <code>microsoft/react-native-windows-samples</code></a></li>
<li><a href="https://github.com/microsoft/react-native-windows/tree/main/packages/sample-apps">Sample App in <code>microsoft/react-native-windows/packages/microsoft-reactnative-sampleapps</code></a></li>
</ul>
</blockquote>
<p>Sometimes an app needs access to a platform API that React Native doesn't have a corresponding module for yet. Maybe you want to reuse some existing .NET code without having to re-implement it in JavaScript, or write some high performance, multi-threaded code for image processing, a database, or any number of advanced extensions.</p>
<p>React Native was designed such that it is possible for you to write real native code and have access to the full power of the platform. This is a more advanced feature and we don't expect it to be part of the usual development process, however it is essential that it exists. If React Native doesn't support a native feature that you need, you should be able to build it yourself.</p>
<blockquote>
<p>NOTE: If you are building a widget that has a UI component, check out the <a href="/react-native-windows/docs/0.78/view-managers">Native UI Component guide</a>.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="overview"></a><a href="#overview" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h2>
<p>Native modules contain (or wrap) native code which can then be exposed to JS. To accomplish this in React Native for Windows, at a high level you must:</p>
<ol>
<li>Author your native module, which is the class that calls your native code.
<ol>
<li>Add custom attributes to the class. These attributes allow you to define methods, properties, constants, and events that can be referenced from JavaScript.</li>
</ol></li>
<li>Register your native module. Note that native modules defined within your app are automatically registered.
<ol>
<li>Add the package to your React Native application.</li>
</ol></li>
<li>Use your native module from your JavaScript code.</li>
</ol>
<p>React Native for Windows supports authoring native modules in both C# and C++. Examples of both are provided below. Please see the <a href="/react-native-windows/docs/0.78/native-code-language-choice">Choosing C++ or C# for native code</a> note for more information about which to choose.</p>
<blockquote>
<p>NOTE: If you are unable to use the reflection-based annotation approach, you can define native modules directly using the ABI. This is outlined in the <a href="/react-native-windows/docs/0.78/native-modules-advanced">Writing Native Modules without using Attributes</a> document.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="initial-setup"></a><a href="#initial-setup" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Initial Setup</h2>
<p>Follow the <a href="/react-native-windows/docs/0.78/native-modules-setup">Native Modules Setup Guide</a> to create the Visual Studio infrastructure to author your own stand-alone native module for React Native Windows.</p>
<p>Once you have set up your development environment and project structure, you are ready to write code.</p>
<p>Open the Visual Studio solution in the <code>windows</code> folder and add the new files directly to the app project.</p>
<h2><a class="anchor" aria-hidden="true" id="sample-native-module"></a><a href="#sample-native-module" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sample Native Module</h2>
<h3><a class="anchor" aria-hidden="true" id="1-configure-windows-codegen-in-packagejson"></a><a href="#1-configure-windows-codegen-in-packagejson" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Configure windows codegen in <code>package.json</code></h3>
<p>Add the following object to your package's <code>package.json</code> file:</p>
<pre><code class="hljs css language-json">  <span class="token property">"codegenConfig"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"NameOfYourApp"</span><span class="token punctuation">,</span>
    <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"modules"</span><span class="token punctuation">,</span>
    <span class="token property">"jsSrcsDir"</span><span class="token operator">:</span> <span class="token string">"src"</span><span class="token punctuation">,</span>
    <span class="token property">"windows"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"namespace"</span><span class="token operator">:</span> <span class="token string">"YourAppCodegenNamespace"</span><span class="token punctuation">,</span>
      <span class="token property">"cppStringType"</span><span class="token operator">:</span> <span class="token string">"std::string"</span><span class="token punctuation">,</span> <span class="token comment">/* optional */</span>
      <span class="token property">"separateDataTypes"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">/* optional */</span>
      <span class="token property">"outputDirectory"</span><span class="token operator">:</span> <span class="token string">"codegen"</span> <span class="token comment">/* optional */</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<p>The values for <code>name</code>, <code>type</code>, <code>jsSrcsDir</code> are shared with react-native as documented <a href="https://reactnative.dev/docs/next/the-new-architecture/pillars-turbomodules">here</a>.  The <code>windows</code> object will cause the windows-codegen task to generate windows specific codegen for any TurboModule spec files defined within your project.</p>
<ul>
<li><code>windows.namespace</code>: Required. This property controls which C++ namespace these generated files are using.</li>
<li><code>windows.cppStringType</code>: Optional. This property controls which C++ string type is used in generated files. The default value is <code>std::string</code>. You could choose between <code>std::string</code> and <code>std::wstring</code>.</li>
<li><code>windows.separateDataTypes</code>: Optional.
<ul>
<li>The default value is <code>false</code>, in which case <code>NativeAbcSpec.g.h</code> is generated from <code>NativeAbc.ts</code>, or with other recognized file extension.</li>
<li>When it is <code>true</code>:
<ul>
<li><code>NativeAbcDataTypes.h</code> and <code>NativeAbcSpec.g.h</code> are generated. <code>NativeAbcDataTypes.h</code> contains all custom types defined in <code>NativeAbc.ts</code>.</li>
<li><code>NativeAbcSpec.g.h</code> contains all the remaining code.</li>
<li><code>NativeAbcSpec.g.h</code> does not include <code>NativeAbcDataTypes.h</code>.</li>
<li>If there is no custom types, <code>NativeAbcDataTypes.h</code> will not be generated even when <code>windows.separateDataTypes</code> is <code>true</code>.</li>
</ul></li>
</ul></li>
<li><code>windows.outputDirectory</code>: Optional. This property controls where generated files are located. The default value is <code>codegen</code>, which put files in the <code>codegen</code> folder under the working directory. If such folder does not exist at the moment, it will be created.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="2-create-javascript-specification"></a><a href="#2-create-javascript-specification" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Create JavaScript Specification</h3>
<p>Modules should have a definition defined in a typed dialect of JavaScript (either TypeScript or Flow). Codegen will use these specifications to verify the interface provided by your native code.</p>
<p>There are two requirements the file containing this specification must meet:</p>
<ul>
<li>The file <strong>must</strong> be named <code>Native&lt;MODULE_NAME&gt;</code>, with a <code>.js</code> or <code>.jsx</code> extension when using Flow, or a <code>.ts</code>, or <code>.tsx</code> extension when using TypeScript.</li>
<li>The file <strong>must</strong> export a <code>TurboModuleRegistrySpec</code> object.</li>
</ul>
<p>Example Specification file <code>NativeFancyMath.ts</code>:</p>
<pre><code class="hljs css language-ts"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { TurboModule } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native/Libraries/TurboModule/RCTExport'</span>;
<span class="hljs-keyword">import</span> { TurboModuleRegistry } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> Spec <span class="hljs-keyword">extends</span> TurboModule {
  getConstants() : {
    E: <span class="hljs-built_in">number</span>,
    Pi: <span class="hljs-built_in">number</span>,
  };

  add(a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span>, callback: <span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>) : <span class="hljs-built_in">void</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> TurboModuleRegistry.get&lt;Spec&gt;(
  <span class="hljs-string">'FancyMath'</span>
) <span class="hljs-keyword">as</span> Spec | <span class="hljs-literal">null</span>;
</code></pre>
<blockquote>
<p>Note even through this file uses <code>TurboModuleRegistry</code>, Native Modules will still work with this JavaScript.  The code is forward looking and will support Native Modules or TurboModules.</p>
</blockquote>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-102-tab-103" class="nav-link active" data-group="group_102" data-tab="tab-group-102-content-103">C#</div><div id="tab-group-102-tab-104" class="nav-link" data-group="group_102" data-tab="tab-group-102-content-104">C++</div></div><div class="tab-content"><div id="tab-group-102-content-103" class="tab-pane active" data-group="group_102" tabindex="-1"><div><span><h3><a class="anchor" aria-hidden="true" id="attributes"></a><a href="#attributes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Attributes</h3>
<table>
<thead>
<tr><th>Attribute</th><th>Use</th></tr>
</thead>
<tbody>
<tr><td><code>ReactModule</code></td><td>Specifies the class is a native module.</td></tr>
<tr><td><code>ReactMethod</code></td><td>Specifies an asynchronous method.</td></tr>
<tr><td><code>ReactSyncMethod</code></td><td>Specifies a synchronous method.</td></tr>
<tr><td><code>ReactConstant</code></td><td>Specifies a field or property that represents a constant.</td></tr>
<tr><td><code>ReactConstantProvider</code></td><td>Specifies a method that provides a set of constants.</td></tr>
<tr><td><code>ReactEvent</code></td><td>Specifies a field or property that represents an event.</td></tr>
<tr><td><code>ReactStruct</code></td><td>Specifies a <code>struct</code> that can be used in native methods.</td></tr>
<tr><td><code>ReactInit</code></td><td>Specifies a class initialization module.</td></tr>
<tr><td><code>ReactFunction</code></td><td>Specifies a JavaScript function that you want exposed to your native code.</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="3-authoring-your-native-module"></a><a href="#3-authoring-your-native-module" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Authoring your Native Module</h3>
<p>Here is a sample native module written in C# called <code>FancyMath</code>. It is a simple class that defines two numerical constants and a method 'add'.</p>
<p><code>FancyMath.cs</code>:</p>
<pre><code class="hljs css language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span><br /><span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>ReactNative<span class="token punctuation">.</span>Managed</span><span class="token punctuation">;</span><br /><br /><span class="token keyword">namespace</span> <span class="token namespace">NativeModuleSample</span><br /><span class="token punctuation">{</span><br />  <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactModule</span></span><span class="token punctuation">]</span><br />  <span class="token keyword">class</span> <span class="token class-name">FancyMath</span><br />  <span class="token punctuation">{</span><br />    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactConstant</span></span><span class="token punctuation">]</span><br />    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> E <span class="token operator">=</span> Math<span class="token punctuation">.</span>E<span class="token punctuation">;</span><br /><br />    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactConstant</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Pi"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><br />    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> PI <span class="token operator">=</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">;</span><br /><br />    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactMethod</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"add"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><br />    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">double</span></span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> a<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> b<span class="token punctuation">)</span><br />    <span class="token punctuation">{</span><br />        <span class="token class-name"><span class="token keyword">double</span></span> result <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span><br />        <span class="token function">AddEvent</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span><br />        <span class="token keyword">return</span> result<span class="token punctuation">;</span><br />    <span class="token punctuation">}</span><br /><br />    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ReactEvent</span></span><span class="token punctuation">]</span><br />    <span class="token keyword">public</span> <span class="token return-type class-name">ReactEvent<span class="token punctuation">&lt;</span><span class="token keyword">double</span><span class="token punctuation">></span></span> AddEvent <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><br />  <span class="token punctuation">}</span><br /><span class="token punctuation">}</span><br /></code></pre>
<p>First off, you see that we're making use of the <code>Microsoft.ReactNative.Managed</code> shared library, which provides the easiest (and recommended) experience for authoring native modules. <code>Microsoft.ReactNative.Managed</code> provides the mechanism that discovers the native module annotations to build bindings at runtime.</p>
<p>The <code>[ReactModule]</code> attribute says that the class is a React Native native module. It has an optional parameter for the module name visible to JavaScript and optionally the name of a registered event emitter. By default, the name visible to JavaScript is the same as the class name, and the default event emitter is <code>RCTDeviceEventEmitter</code>.</p>
<p>You can overwrite the JavaScript module name like this: <code>[ReactModule(&quot;math&quot;)]</code>.</p>
<p>You can specify a different event emitter like this: <code>[ReactModule(EventEmitter = &quot;mathEmitter&quot;)]</code>.</p>
<blockquote>
<p>NOTE: Using the default event emitter, <code>RCTDeviceEventEmitter</code>, all native event names must be <strong>globally unique across all native modules</strong> (even the ones built-in to RN). However, specifying your own event emitter means you'll need to create and register that too. This process is outlined in the <a href="/react-native-windows/docs/0.78/native-modules-advanced">Native Modules and React Native Windows (Advanced Topics)</a> document.</p>
</blockquote>
<p>The <code>[ReactConstant]</code> attribute is how you can define constants. Here <code>FancyMath</code> has defined two constants: <code>E</code> and <code>Pi</code>. When accessing these constants you should use <code>FancyMath.getConstants().E</code>.  If you want to use another name in JS you could override the JS name like this: <code>[ReactConstant(&quot;e&quot;)]</code>.</p>
<p>The <code>[ReactMethod]</code> attribute is how you define methods. In <code>FancyMath</code> we have one method, <code>add</code>, which takes two doubles and returns their sum. As before, you can optionally customize the name like this: <code>[ReactMethod(&quot;add&quot;)]</code>.</p>
<p>The <code>[ReactEvent]</code> attribute is how you define events. In <code>FancyMath</code> we have one event, <code>AddEvent</code>, which uses the <code>ReactEvent&lt;double&gt;</code> delegate, where the double represents the type of the event data. Now whenever we invoke the <code>AddEvent</code> delegate in our native code (as we do above), an event named <code>&quot;AddEvent&quot;</code> will be raised in JavaScript. As before, you could have optionally customized the name in JS like this: <code>[ReactEvent(&quot;addEvent&quot;)]</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="4-registering-your-native-module"></a><a href="#4-registering-your-native-module" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Registering your Native Module</h3>
<blockquote>
<p>IMPORTANT NOTE: When you create a new project via the CLI, the generated <code>ReactApplication</code> class will automatically register all native modules defined within the app. <strong>You will not need to manually register native modules that are defined within your app's scope, as they will be registered automatically.</strong></p>
</blockquote>
<p>Now, we want to register our new <code>FancyMath</code> module with React Native so we can use it from JavaScript code. To do this, first we're going to create a <code>ReactPackageProvider</code> which implements <a href="https://github.com/microsoft/react-native-windows/blob/main/vnext/Microsoft.ReactNative/IReactPackageProvider.idl"><code>Microsoft.ReactNative.IReactPackageProvider</code></a>.</p>
<p><code>ReactPackageProvider.cs</code>:</p>
<pre><code class="hljs css language-csharp"><span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>ReactNative<span class="token punctuation">.</span>Managed</span><span class="token punctuation">;</span><br /><br /><span class="token keyword">namespace</span> <span class="token namespace">NativeModuleSample</span><br /><span class="token punctuation">{</span><br />  <span class="token keyword">public</span> <span class="token keyword">sealed</span> <span class="token keyword">class</span> <span class="token class-name">ReactPackageProvider</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IReactPackageProvider</span></span><br />  <span class="token punctuation">{</span><br />    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">CreatePackage</span><span class="token punctuation">(</span><span class="token class-name">IReactPackageBuilder</span> packageBuilder<span class="token punctuation">)</span><br />    <span class="token punctuation">{</span><br />      packageBuilder<span class="token punctuation">.</span><span class="token function">AddAttributedModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token punctuation">}</span><br />  <span class="token punctuation">}</span><br /><span class="token punctuation">}</span><br /></code></pre>
<p>Here we've implemented the <code>CreatePackage</code> method, which receives <code>packageBuilder</code> to build contents of the package. Since we use reflection to discover and bind native module, we call <code>AddAttributedModules</code> extension method to register all native modules in our assembly that have the <code>ReactModule</code> attribute.</p>
<p>Now that we have the <code>ReactPackageProvider</code>, it's time to register it within our <code>ReactApplication</code>. We do that by simply adding the provider to the <code>PackageProviders</code> property.</p>
<p><code>App.xaml.cs</code>:</p>
<pre><code class="hljs css language-csharp"><span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>ReactNative</span><span class="token punctuation">;</span><br /><br /><span class="token keyword">namespace</span> <span class="token namespace">SampleApp</span><br /><span class="token punctuation">{</span><br />    <span class="token keyword">sealed</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ReactApplication</span></span><br />    <span class="token punctuation">{</span><br />        <span class="token keyword">public</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br />        <span class="token punctuation">{</span><br />            <span class="token comment">/* Other Init Code */</span><br /><br />            PackageProviders<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Microsoft<span class="token punctuation">.</span>ReactNative<span class="token punctuation">.</span>Managed<span class="token punctuation">.</span>ReactPackageProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Includes any modules in this project</span><br />            PackageProviders<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">NativeModuleSample<span class="token punctuation">.</span>ReactPackageProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><br />            <span class="token comment">/* Other Init Code */</span><br />        <span class="token punctuation">}</span><br />    <span class="token punctuation">}</span><br /><span class="token punctuation">}</span><br /></code></pre>
<p>This example assumes that the <code>NativeModuleSample.ReactPackageProvider</code> we created above is in a different project (assembly) than our application. However you'll notice that by default we also added a <code>Microsoft.ReactNative.Managed.ReactPackageProvider</code>.</p>
<p>The <code>Microsoft.ReactNative.Managed.ReactPackageProvider</code> is a convenience that makes sure that all native modules and view managers defined within the app project automatically get registered. So if you're creating your native modules directly within the app project, you won't actually want to define a separate <code>ReactPackageProvider</code>.</p>
</span></div></div><div id="tab-group-102-content-104" class="tab-pane" data-group="group_102" tabindex="-1"><div><span><h3><a class="anchor" aria-hidden="true" id="attributes"></a><a href="#attributes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Attributes</h3>
<table>
<thead>
<tr><th>Attribute</th><th>Use</th></tr>
</thead>
<tbody>
<tr><td><code>REACT_MODULE</code></td><td>Specifies the class is a native module, making this module recognizable by <code>AddAttributedModules</code> function.</td></tr>
<tr><td><code>REACT_MODULE_NOREG</code></td><td>Specifies the class is a native module.</td></tr>
<tr><td><code>REACT_METHOD</code></td><td>Specifies an asynchronous method.</td></tr>
<tr><td><code>REACT_SYNC_METHOD</code></td><td>Specifies a synchronous method.</td></tr>
<tr><td><code>REACT_GET_CONSTANTS</code></td><td>Specifies a method that provides a set of constants. (Preferred)</td></tr>
<tr><td><code>REACT_CONSTANT</code></td><td>Specifies a field or property that represents a constant.</td></tr>
<tr><td><code>REACT_CONSTANTPROVIDER</code></td><td>Specifies a method that provides a set of constants.</td></tr>
<tr><td><code>REACT_EVENT</code></td><td>Specifies a field or property that represents an event.</td></tr>
<tr><td><code>REACT_STRUCT</code></td><td>Specifies a <code>struct</code> that can be used in native methods (don't nest the definition inside <code>REACT_MODULE</code>).</td></tr>
<tr><td><code>REACT_INIT</code></td><td>Specifies a class initialization module.</td></tr>
<tr><td><code>ReactFunction</code></td><td>Specifies a JavaScript function that you want exposed to your native code.</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="3-authoring-your-native-module"></a><a href="#3-authoring-your-native-module" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Authoring your Native Module</h3>
<p>Here is a sample native module written in C++ called <code>FancyMath</code>. It is a simple class that defines two numerical constants and a method 'add'.</p>
<p><code>FancyMath.h</code>:</p>
<pre><code class="hljs css language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span><br /><br /><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"pch.h"</span></span><br /><br /><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;codegen\FancyMathSpec.g.h></span> <span class="token comment">// This file will be generated by the windows-codegen command from your js spec file</span></span><br /><br /><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional></span></span><br /><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_USE_MATH_DEFINES</span></span><br /><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><br /><br /><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"NativeModules.h"</span></span><br /><br /><span class="token keyword">namespace</span> NativeModuleSample<br /><span class="token punctuation">{</span><br />  <span class="token function">REACT_MODULE</span><span class="token punctuation">(</span>FancyMath<span class="token punctuation">)</span><span class="token punctuation">;</span><br />  <span class="token keyword">struct</span> <span class="token class-name">FancyMath</span><br />  <span class="token punctuation">{</span><br />    <span class="token comment">// The namespace here will align with the codegenConfig.windows.namespace property in your package.json</span><br />    <span class="token keyword">using</span> ModuleSpec <span class="token operator">=</span> YourAppCodegenNamespace<span class="token double-colon punctuation">::</span>FancyMathSpec<span class="token punctuation">;</span> <br /><br />    <span class="token function">REACT_GET_CONSTANTS</span><span class="token punctuation">(</span>GetConstants<span class="token punctuation">)</span><br />    SampleLibraryCodegen<span class="token double-colon punctuation">::</span>FancyMathSpec_Constants <span class="token function">GetConstants</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">noexcept</span> <span class="token punctuation">{</span><br />      SampleLibraryCodegen<span class="token double-colon punctuation">::</span>FancyMathSpec_Constants constants<span class="token punctuation">;</span><br />      constants<span class="token punctuation">.</span>E <span class="token operator">=</span> M_E<span class="token punctuation">;</span><br />      constants<span class="token punctuation">.</span>Pi <span class="token operator">=</span> M_PI<span class="token punctuation">;</span><br />      <span class="token keyword">return</span> constants<span class="token punctuation">;</span><br />    <span class="token punctuation">}</span><br /><br />    <span class="token function">REACT_METHOD</span><span class="token punctuation">(</span>Add<span class="token punctuation">,</span> L<span class="token string">"add"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token keyword">double</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">double</span> a<span class="token punctuation">,</span> <span class="token keyword">double</span> b<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><br />    <span class="token punctuation">{</span><br />      <span class="token keyword">double</span> result <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span><br />      <span class="token function">AddEvent</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span><br />      <span class="token keyword">return</span> result<span class="token punctuation">;</span><br />    <span class="token punctuation">}</span><br /><br />    <span class="token function">REACT_EVENT</span><span class="token punctuation">(</span>AddEvent<span class="token punctuation">)</span><span class="token punctuation">;</span><br />    std<span class="token double-colon punctuation">::</span>function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token operator">></span> AddEvent<span class="token punctuation">;</span><br />  <span class="token punctuation">}</span><span class="token punctuation">;</span><br /><span class="token punctuation">}</span><br /></code></pre>
<p>The <code>REACT_MODULE</code> macro-attribute says that the class is a React Native native module. It receives the class name as a first parameter. All other macro-attributes also receive their target as a first parameter. <code>REACT_MODULE</code> has an optional parameter for the module name visible to JavaScript and optionally the name of a registered event emitter. By default, the name visible to JavaScript is the same as the class name, and the default event emitter is <code>RCTDeviceEventEmitter</code>.</p>
<p>It is important to specify the <code>ModuleSpec</code>.  Defining <code>ModuleSpec</code> will enforce that your module defines the same methods as the JS spec file.</p>
<blockquote>
<p>NOTE: Methods annotated with <code>REACT_METHOD</code> and friends must have the <code>noexcept</code> specifier, otherwise the program will not compile. Module authors should make sure all exceptions are handled inside the method.</p>
</blockquote>
<p>You can overwrite the JavaScript module name like this: <code>REACT_MODULE(FancyMath, L&quot;math&quot;)</code>.</p>
<p>You can specify a different event emitter like this: <code>REACT_MODULE(FancyMath, L&quot;math&quot;, L&quot;mathEmitter&quot;)</code>.</p>
<blockquote>
<p>NOTE: Using the default event emitter, <code>RCTDeviceEventEmitter</code>, all native event names must be <strong>globally unique across all native modules</strong> (even the ones built-in to RN). However, specifying your own event emitter means you'll need to create and register that too. This process is outlined in the <a href="/react-native-windows/docs/0.78/native-modules-advanced">Native Modules and React Native Windows (Advanced Topics)</a> document.</p>
</blockquote>
<p>Then we define constants, this is done using the <code>REACT_GET_CONSTANTS</code> macro-attribute.  In this case we are returning a struct which was defined using <code>REACT_STRUCT</code>.  This generates code to automatically translate the struct into a <code>JSValueObject</code>.</p>
<p>It's just as easy to add custom methods, by attributing a public method with <code>REACT_METHOD</code>. In <code>FancyMath</code> we have one method, <code>add</code>, which takes two doubles and returns their sum. Again, we've specified the optional <code>name</code> argument in the <code>REACT_METHOD</code> macro-attribute so in JS we call <code>add</code> instead of <code>Add</code>.</p>
<p>Native modules do not have the ability to check that the parameter types and the number of parameters match between what's called from JavaScript and what the native code accepts. However, the framework will validate that the number of promises-like parameters match: if the JavaScript API is <code>async</code>, it will expect that there is one &quot;promise-like&quot; parameter in the native method implementation signature.</p>
<p>A &quot;promise-like&quot; parameter is either:</p>
<ul>
<li><code>React::ReactPromise&lt;T&gt;</code></li>
<li>a callback function or functor.</li>
</ul>
<p>See <a href="/react-native-windows/docs/0.78/native-modules-async">Using Asynchronous Windows APIs</a>.</p>
<p>Here is an example of an <code>async</code> method that returns a string:</p>
<pre><code class="hljs css language-cpp">    <span class="token function">REACT_METHOD</span><span class="token punctuation">(</span>GetString<span class="token punctuation">,</span> L<span class="token string">"getString"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token keyword">void</span> <span class="token function">GetString</span><span class="token punctuation">(</span>React<span class="token double-colon punctuation">::</span>ReactPromise<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token operator">></span><span class="token operator">&amp;&amp;</span> result<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><br />    <span class="token punctuation">{</span><br />      <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><br />        result<span class="token punctuation">.</span><span class="token function">Reject</span><span class="token punctuation">(</span><span class="token string">"Failure"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br />        std<span class="token double-colon punctuation">::</span>string text <span class="token operator">=</span> <span class="token function">DoSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />        result<span class="token punctuation">.</span><span class="token function">Resolve</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span><br />      <span class="token punctuation">}</span><br />    <span class="token punctuation">}</span><br /></code></pre>
<p>This can be also tied in with C++/WinRT event handlers or <code>IAsyncOperation&lt;T&gt;</code> like so:</p>
<pre><code class="hljs css language-cpp">    <span class="token function">REACT_METHOD</span><span class="token punctuation">(</span>GetString<span class="token punctuation">,</span> L<span class="token string">"getString"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token keyword">void</span> <span class="token function">GetString</span><span class="token punctuation">(</span>React<span class="token double-colon punctuation">::</span>ReactPromise<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token operator">></span><span class="token operator">&amp;&amp;</span> result<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><br />    <span class="token punctuation">{</span><br />      <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><br />        result<span class="token punctuation">.</span><span class="token function">Reject</span><span class="token punctuation">(</span><span class="token string">"Failure"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br />        something<span class="token punctuation">.</span><span class="token function">Completed</span><span class="token punctuation">(</span><span class="token punctuation">[</span>result<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> operation<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> status<span class="token punctuation">)</span> <span class="token punctuation">{</span><br />          <span class="token comment">// do error checking, e.g. status should be Completed</span><br />          winrt<span class="token double-colon punctuation">::</span>hstring result<span class="token punctuation">{</span>operation<span class="token punctuation">.</span><span class="token function">GetResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br />          result<span class="token punctuation">.</span><span class="token function">Resolve</span><span class="token punctuation">(</span>winrt<span class="token double-colon punctuation">::</span><span class="token function">to_string</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />      <span class="token punctuation">}</span><br />    <span class="token punctuation">}</span><br /></code></pre>
<p>See <a href="#javascript-and-windows-runtime-strings">JavaScript and Windows Runtime strings</a> for more details.</p>
<p>The <a href="/react-native-windows/docs/0.78/native-modules-jsvalue"><code>JSValue</code></a> type can be used when the API returns a JavaScript objects or takes JavaScript objects as input parameters.</p>
<p>Native modules will want to use <code>REACT_METHOD</code> instead of <code>REACT_SYNC_METHOD</code> since the latter precludes web debugging and has performance implications. When using web debugging you will see an exception that reads:
<code>Calling synchronous methods on native modules is not supported in Chrome. Consider providing alternative to expose this method in debug mode, e.g. by exposing constants ahead-of-time</code>
See: <a href="https://github.com/facebook/react-native/blob/e27d656ef370958c864b052123ec05579ac9fc01/Libraries/BatchedBridge/MessageQueue.js#L175"><code>MessageQueue.js</code></a>.</p>
<p>To add custom events, we attribute a <code>std::function&lt;void(double)&gt;</code> delegate with <code>REACT_EVENT</code>, where the double represents the type of the event data. Now whenever we invoke the <code>AddEvent</code> delegate in our native code (as we do above), an event named <code>&quot;AddEvent&quot;</code> will be raised in JavaScript. As before, you could have optionally customized the name in JS like this: <code>REACT_EVENT(AddEvent, &quot;addEvent&quot;)</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="4-registering-your-native-module"></a><a href="#4-registering-your-native-module" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Registering your Native Module</h3>
<blockquote>
<p>IMPORTANT NOTE: When you create a new project via the CLI, the generated <code>ReactApplication</code> class will automatically register all native modules defined within the app. <strong>You will not need to manually register native modules that are defined within your app's scope, as they will be registered automatically.</strong></p>
</blockquote>
<p>Now, we want to register our new <code>FancyMath</code> module with React Native so we can use it from JavaScript code. To do this, first we're going to create a <code>ReactPackageProvider</code> which implements <a href="https://github.com/microsoft/react-native-windows/blob/main/vnext/Microsoft.ReactNative/IReactPackageProvider.idl"><code>Microsoft.ReactNative.IReactPackageProvider</code></a>. It starts with defining an interface definition (<code>.idl</code>) file:</p>
<p><code>ReactPackageProvider.idl</code>:</p>
<pre><code class="hljs css language-c++"><span class="hljs-keyword">namespace</span> NativeModuleSample<br />{<br />    [webhosthidden]<br />    [default_interface]<br />    runtimeclass ReactPackageProvider : Microsoft.ReactNative.IReactPackageProvider<br />    {<br />        ReactPackageProvider();<br />    };<br />}<br /></code></pre>
<p>After that we add the .h and .cpp files:</p>
<p><code>ReactPackageProvider.h</code>:</p>
<pre><code class="hljs css language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span><br /><br /><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ReactPackageProvider.g.h"</span></span><br /><br /><span class="token keyword">using</span> <span class="token keyword">namespace</span> winrt<span class="token double-colon punctuation">::</span>Microsoft<span class="token double-colon punctuation">::</span>ReactNative<span class="token punctuation">;</span><br /><br /><span class="token keyword">namespace</span> winrt<span class="token double-colon punctuation">::</span>NativeModuleSample<span class="token double-colon punctuation">::</span>implementation<br /><span class="token punctuation">{</span><br />    <span class="token keyword">struct</span> <span class="token class-name">ReactPackageProvider</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">ReactPackageProviderT</span><span class="token operator">&lt;</span><span class="token class-name">ReactPackageProvider</span><span class="token operator">></span></span><br />    <span class="token punctuation">{</span><br />        <span class="token function">ReactPackageProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><br /><br />        <span class="token keyword">void</span> <span class="token function">CreatePackage</span><span class="token punctuation">(</span>IReactPackageBuilder <span class="token keyword">const</span><span class="token operator">&amp;</span> packageBuilder<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token punctuation">;</span><br />    <span class="token punctuation">}</span><span class="token punctuation">;</span><br /><span class="token punctuation">}</span><br /><br /><span class="token keyword">namespace</span> winrt<span class="token double-colon punctuation">::</span>NativeModuleSample<span class="token double-colon punctuation">::</span>factory_implementation<br /><span class="token punctuation">{</span><br />    <span class="token keyword">struct</span> <span class="token class-name">ReactPackageProvider</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">ReactPackageProviderT</span><span class="token operator">&lt;</span><span class="token class-name">ReactPackageProvider</span><span class="token punctuation">,</span> implementation<span class="token double-colon punctuation">::</span><span class="token class-name">ReactPackageProvider</span><span class="token operator">></span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br /><span class="token punctuation">}</span><br /></code></pre>
<p><code>ReactPackageProvider.cpp</code>:</p>
<pre><code class="hljs css language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"pch.h"</span></span><br /><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ReactPackageProvider.h"</span></span><br /><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ReactPackageProvider.g.cpp"</span></span><br /><br /><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ModuleRegistration.h></span></span><br /><br /><span class="token comment">// NOTE: You must include the headers of your native modules here in</span><br /><span class="token comment">// order for the AddAttributedModules call below to find them.</span><br /><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"FancyMath.h"</span></span><br /><br /><span class="token keyword">namespace</span> winrt<span class="token double-colon punctuation">::</span>NativeModuleSample<span class="token double-colon punctuation">::</span>implementation<br /><span class="token punctuation">{</span><br />    <span class="token keyword">void</span> <span class="token class-name">ReactPackageProvider</span><span class="token double-colon punctuation">::</span><span class="token function">CreatePackage</span><span class="token punctuation">(</span>IReactPackageBuilder <span class="token keyword">const</span><span class="token operator">&amp;</span> packageBuilder<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><br />    <span class="token punctuation">{</span><br />        <span class="token function">AddAttributedModules</span><span class="token punctuation">(</span>packageBuilder<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token punctuation">}</span><br /><span class="token punctuation">}</span><br /></code></pre>
<p>If <code>REACT_MODULE_NOREG</code> is used instead of <code>REACT_MODULE</code>, <code>AddAttributedModules</code> will not register this module for you. Such module should be registered manually:</p>
<pre><code class="hljs css language-cpp">packageBuilder<span class="token punctuation">.</span><span class="token function">AddTurboModule</span><span class="token punctuation">(</span>L<span class="token string">"FancyMath"</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">MakeModuleProvider</span><span class="token generic class-name"><span class="token operator">&lt;</span>NativeModuleSample<span class="token double-colon punctuation">::</span>FancyMath<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /></code></pre>
<p>Here we've implemented the <code>CreatePackage</code> method, which receives <code>packageBuilder</code> to build contents of the package. Since we use macros and templates to discover and bind native module, we call <code>AddAttributedModules</code> function to register all native modules in our DLL that have the <code>REACT_MODULE</code> macro-attribute. Specifying true here will register all the native modules as TurboModules rather than Native Modules.  This will avoid some additional serialization that happens with Native Module calls.  If for some reason you need the modules to continue to run as Native Modules, you can specify false here.</p>
<p>See <a href="/react-native-windows/docs/0.78/native-modules-vs-turbo-modules">Native Modules vs Turbo Modules</a> for more details on TurboModules.</p>
<p>Now that we have the <code>ReactPackageProvider</code>, it's time to register it within our <code>ReactApplication</code>. We do that by simply adding the provider to the <code>PackageProviders</code> property.</p>
<p><code>App.cpp</code>:</p>
<pre><code class="hljs css language-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"pch.h"</span></span><br /><br /><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"App.h"</span></span><br /><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"ReactPackageProvider.h"</span></span><br /><br /><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"winrt/NativeModuleSample.h"</span></span><br /><br /><span class="hljs-keyword">namespace</span> winrt::SampleApp::implementation {<br /><br />App::App() <span class="hljs-keyword">noexcept</span> {<br />  <span class="hljs-comment">/* Other Init Code */</span><br /><br />  PackageProviders().Append(make&lt;ReactPackageProvider&gt;()); <span class="hljs-comment">// Includes all modules in this project</span><br />  PackageProviders().Append(winrt::NativeModuleSample::ReactPackageProvider());<br /><br />  <span class="hljs-comment">/* Other Init Code */</span><br />}<br /><br />} <span class="hljs-comment">// namespace winrt::SampleApp::implementation</span><br /></code></pre>
<p>This example assumes that the <code>NativeModuleSample::ReactPackageProvider</code> we created above is in a different project (assembly) than our application. However you'll notice that by default we also added a <code>SampleApp::ReactPackageProvider</code>.</p>
<p>The <code>SampleApp::ReactPackageProvider</code> is a convenience that makes sure that all native modules and view managers defined within the app project automatically get registered. So if you're creating your native modules directly within the app project, you won't actually want to define a separate <code>ReactPackageProvider</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="javascript-and-windows-runtime-strings"></a><a href="#javascript-and-windows-runtime-strings" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JavaScript and Windows Runtime strings</h3>
<p>Note that JavaScript strings are UTF8 (i.e. <code>std::string</code>) but WinRT strings are UTF16 (i.e. <code>winrt::hstring</code> in C++/WinRT), so when inter-operating between JavaScript and WinRT APIs, you will need to convert between these two encodings.
See <a href="https://docs.microsoft.com/en-us/windows/uwp/cpp-and-winrt-apis/strings">String handling in C++/WinRT</a>, specifically <a href="https://docs.microsoft.com/uwp/cpp-ref-for-winrt/to-string"><code>winrt::to_string</code></a> and <a href="https://docs.microsoft.com/uwp/cpp-ref-for-winrt/to-hstring"><code>winrt::to_hstring</code></a>.</p>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="5-using-your-native-module-in-js"></a><a href="#5-using-your-native-module-in-js" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. Using your Native Module in JS</h3>
<p>Now we have a Native Module which is registered with React Native Windows. How do we access it in JS? Here's a simple RN app:</p>
<p><code>NativeModuleSample.js</code>:</p>
<pre><code class="hljs css language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  AppRegistry<span class="token punctuation">,</span>
  Alert<span class="token punctuation">,</span>
  Text<span class="token punctuation">,</span>
  View<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-native'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> FancyMath <span class="token keyword">from</span> <span class="token string">'./NativeFancyMath'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NativeEventEmitter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-native'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> FancyMathEventEmitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NativeEventEmitter</span><span class="token punctuation">(</span>FancyMath<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">NativeModuleSample</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>

  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Subscribing to FancyMath.AddEvent</span>
    FancyMathEventEmitter<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">'AddEvent'</span><span class="token punctuation">,</span> eventHandler<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Unsubscribing from FancyMath.AddEvent</span>
    FancyMathEventEmitter<span class="token punctuation">.</span><span class="token function">removeListener</span><span class="token punctuation">(</span><span class="token string">'AddEvent'</span><span class="token punctuation">,</span> eventHandler<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">eventHandler</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Event was fired with: "</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">_onPressHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Calling FancyMath.add method</span>
    FancyMath<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
      <span class="token comment">/* arg a */</span> FancyMath<span class="token punctuation">.</span><span class="token function">getConstants</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Pi<span class="token punctuation">,</span>
      <span class="token comment">/* arg b */</span> FancyMath<span class="token punctuation">.</span><span class="token constant">E</span><span class="token punctuation">,</span>
      <span class="token comment">/* callback */</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Alert<span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span>
          <span class="token string">'FancyMath'</span><span class="token punctuation">,</span>
          <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">FancyMath says </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>FancyMath<span class="token punctuation">.</span><span class="token function">getConstants</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Pi<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>FancyMath<span class="token punctuation">.</span><span class="token function">getConstants</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token constant">E</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'OK'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span><span class="token literal-property property">cancelable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">View</span></span><span class="token punctuation">></span></span><span class="token plain-text">
         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Text</span></span><span class="token punctuation">></span></span><span class="token plain-text">FancyMath says PI = </span><span class="token punctuation">{</span>FancyMath<span class="token punctuation">.</span><span class="token function">getConstants</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Pi<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Text</span></span><span class="token punctuation">></span></span><span class="token plain-text">
         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Text</span></span><span class="token punctuation">></span></span><span class="token plain-text">FancyMath says E = </span><span class="token punctuation">{</span>FancyMath<span class="token punctuation">.</span><span class="token function">getConstants</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token constant">E</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Text</span></span><span class="token punctuation">></span></span><span class="token plain-text">
         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">onPress</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>_onPressHandler<span class="token punctuation">}</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Click me!<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">View</span></span><span class="token punctuation">></span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

AppRegistry<span class="token punctuation">.</span><span class="token function">registerComponent</span><span class="token punctuation">(</span><span class="token string">'NativeModuleSample'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> NativeModuleSample<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>To access your native modules, you need to import from your spec file, in this case <code>NativeFancyMath</code>. Since our modules fires events, we're also bringing in <code>NativeEventEmitter</code>.</p>
<p>To access our <code>FancyMath</code> constants, we can simply call <code>FancyMath.getConstants().E</code> and <code>FancyMath.getConstants().Pi</code>.</p>
<p>Calls to methods are a little different due to the asynchronous nature of the JS engine. If the native method returns nothing, we can simply call the method. However, in this case <code>FancyMath.add()</code> returns a value, so in addition to the two necessary parameters we also include a callback function which will be called with the result of <code>FancyMath.add()</code>. In the example above, we can see that the callback raises an Alert dialog with the result value.</p>
<p>For events, you'll see that we created an instance of <code>NativeEventEmitter</code> passing in our <code>FancyMath</code> module, and called it <code>FancyMathEventEmitter</code>. We can then use the <code>FancyMathEventEmitter.addListener()</code> and <code>FancyMathEventEmitter.removeListener()</code> methods to subscribe to our <code>FancyMath.AddEvent</code>. In this case, when <code>AddEvent</code> is fired in the native code, <code>eventHandler</code> will get called, which logs the result to the console log.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 7/10/2025</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/react-native-windows/docs/0.78/run-windows-cli"><span class="arrow-prev">← </span><span>react-native run-windows</span></a><a class="docs-next button" href="/react-native-windows/docs/0.78/view-managers"><span>Native UI Components</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#overview">Overview</a></li><li><a href="#initial-setup">Initial Setup</a></li><li><a href="#sample-native-module">Sample Native Module</a><ul class="toc-headings"><li><a href="#1-configure-windows-codegen-in-packagejson">1. Configure windows codegen in <code>package.json</code></a></li><li><a href="#2-create-javascript-specification">2. Create JavaScript Specification</a></li><li><a href="#attributes">Attributes</a></li><li><a href="#3-authoring-your-native-module">3. Authoring your Native Module</a></li><li><a href="#4-registering-your-native-module">4. Registering your Native Module</a></li><li><a href="#attributes-1">Attributes</a></li><li><a href="#3-authoring-your-native-module-1">3. Authoring your Native Module</a></li><li><a href="#4-registering-your-native-module-1">4. Registering your Native Module</a></li><li><a href="#javascript-and-windows-runtime-strings">JavaScript and Windows Runtime strings</a></li><li><a href="#5-using-your-native-module-in-js">5. Using your Native Module in JS</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><div><h5>React Native Docs</h5><a href="https://reactnative.dev/docs/getting-started">Getting Started</a><a href="https://reactnative.dev/docs/tutorial">Tutorial</a><a href="https://reactnative.dev/docs/components-and-apis">Components and APIs</a><a href="https://reactnative.dev/docs/more-resources">More Resources</a></div><div><h5>React Native for Windows Docs</h5><div style="color:white;font-weight:500;font-size:16px"><a href="/react-native-windows/docs/getting-started">Get Started with Windows</a></div><a href="/react-native-windows/docs/parity-status">React Native Windows Components and APIs</a><a href="/react-native-windows/docs/native-modules">Native Modules</a><a href="/react-native-windows/docs/view-managers">Native UI Components</a></div><div><h5>Connect With Us On</h5><a href="https://devblogs.microsoft.com/react-native/">Blog</a><a href="https://twitter.com/ReactNativeMSFT" target="_blank">Twitter</a><a href="https://github.com/microsoft/react-native-windows" target="_blank">GitHub</a><a href="https://github.com/microsoft/react-native-windows-samples/tree/main/samples" target="_blank">Samples</a></div></section></footer></div></body></html>