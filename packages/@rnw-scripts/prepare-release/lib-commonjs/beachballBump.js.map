{"version":3,"file":"beachballBump.js","sourceRoot":"","sources":["../src/beachballBump.ts"],"names":[],"mappings":";AAAA;;;;;;;GAOG;;;;;;AAEH,4CAAoB;AACpB,gDAAwB;AAExB,iCAA4B;AAE5B;;;;;GAKG;AACH,SAAgB,cAAc,CAAC,QAAgB;IAC7C,MAAM,SAAS,GAAG,cAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;IAChD,IAAI,CAAC,YAAE,CAAC,UAAU,CAAC,SAAS,CAAC,EAAE;QAC7B,OAAO,KAAK,CAAC;KACd;IAED,MAAM,OAAO,GAAG,YAAE,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;IAC1C,OAAO,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;AACxD,CAAC;AARD,wCAQC;AAED;;;;;;;;GAQG;AACI,KAAK,UAAU,YAAY,CAAC,IAIlC;IACC,MAAM,IAAA,WAAI,EACR,+BAA+B,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,kBAAkB,EACjF,EAAC,GAAG,EAAE,IAAI,CAAC,GAAG,EAAC,CAChB,CAAC;AACJ,CAAC;AATD,oCASC","sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n * Licensed under the MIT License.\n *\n * Beachball change file detection and version bump invocation.\n *\n * @format\n */\n\nimport fs from 'fs';\nimport path from 'path';\n\nimport {exec} from './proc';\n\n/**\n * Check whether there are pending beachball change files in the repo.\n *\n * Beachball stores change files as JSON in the `change/` directory at the\n * repo root. If there are any .json files there, there are pending changes.\n */\nexport function hasChangeFiles(repoRoot: string): boolean {\n  const changeDir = path.join(repoRoot, 'change');\n  if (!fs.existsSync(changeDir)) {\n    return false;\n  }\n\n  const entries = fs.readdirSync(changeDir);\n  return entries.some(entry => entry.endsWith('.json'));\n}\n\n/**\n * Run beachball bump to consume change files and update versions/changelogs.\n *\n * Invokes: npx beachball bump --branch <remote>/<target> --yes --verbose\n *\n * The --yes flag suppresses prompts.\n * The --verbose flag provides detailed output.\n * The --branch flag tells beachball the baseline branch to diff against.\n */\nexport async function bumpVersions(opts: {\n  targetBranch: string;\n  remote: string;\n  cwd: string;\n}): Promise<void> {\n  await exec(\n    `npx beachball bump --branch ${opts.remote}/${opts.targetBranch} --yes --verbose`,\n    {cwd: opts.cwd},\n  );\n}\n"]}