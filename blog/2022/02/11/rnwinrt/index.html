<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Calling Windows APIs from React Native just got easier · React Native for Windows + macOS</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;head&gt;"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Calling Windows APIs from React Native just got easier · React Native for Windows + macOS"/><meta property="og:type" content="website"/><meta property="og:url" content="https://microsoft.github.io/react-native-windows/blog/2022/02/11/rnwinrt"/><meta property="og:description" content="&lt;head&gt;"/><meta property="og:image" content="https://microsoft.github.io/react-native-windows/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://microsoft.github.io/react-native-windows/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/react-native-windows/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-dark.min.css"/><link rel="stylesheet" href="/react-native-windows/css/code-block-buttons.css"/><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/focus-visible@5.0.2/dist/focus-visible.min.js"></script><script type="text/javascript" src="https://platform.twitter.com/widgets.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/react-native-windows/js/code-block-buttons.js"></script><script type="text/javascript" src="/react-native-windows/js/nav-buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/react-native-windows/js/scrollSpy.js"></script><link rel="stylesheet" href="/react-native-windows/css/prism.css"/><link rel="stylesheet" href="/react-native-windows/css/main.css"/><script src="/react-native-windows/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/react-native-windows/"><img class="logo" src="/react-native-windows/img/header_logo.svg" alt="React Native for Windows + macOS"/><h2 class="headerTitleWithLogo">React Native for Windows + macOS</h2></a><a href="/react-native-windows/versions"><h3>0.79</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/react-native-windows/docs/getting-started" target="_self">Docs</a></li><li class=""><a href="/react-native-windows/docs/flyout-component" target="_self">APIs</a></li><li class=""><a href="https://devblogs.microsoft.com/react-native/" target="_self">Blog</a></li><li class=""><a href="/react-native-windows/resources" target="_self">Resources</a></li><li class=""><a href="https://github.com/microsoft/react-native-windows-samples/tree/main/samples" target="_self">Samples</a></li><li class=""><a href="/react-native-windows/support" target="_self">Support</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Recent Posts</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Recent Posts</h3><ul class=""><li class="navListItem"><a class="navItem" href="/react-native-windows/blog/2022/07/29/coreapp">Streamlining app creation with React Native for Windows CoreApp</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/blog/2022/02/11/settings">React Native for Windows is helping Settings improve more quickly</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/react-native-windows/blog/2022/02/11/rnwinrt">Calling Windows APIs from React Native just got easier</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/blog/2021/08/05/win32component">Use Win32 features from a React Native for Windows application</a></li><li class="navListItem"><a class="navItem" href="/react-native-windows/blog/2021/06/30/notifications">Add Toast notifications to your React Native for Windows application</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer postContainer blogContainer"><div class="wrapper"><div class="lonePost"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle"><a href="/react-native-windows/blog/2022/02/11/rnwinrt">Calling Windows APIs from React Native just got easier</a></h1><p class="post-meta">February 11, 2022</p><div class="authorBlock"><p class="post-authorName"><a href="https://twitter.com/angelazhangg" target="_blank" rel="noreferrer noopener">Angela Zhang</a></p></div></header><div><span><p><head>
<meta http-equiv="Refresh" content="0; URL=https://devblogs.microsoft.com/react-native/announcing-rnwinrt/" />
</head></p>
<p>We are excited to announce the <a href="http://aka.ms/reactnativewinrt">React Native WinRT</a> project, a new extension that makes it easier for <a href="https://microsoft.github.io/react-native-windows/">React Native for Windows</a> developers to call Windows Runtime APIs directly from JavaScript! With React Native WinRT, developers can light up experiences that take advantage of unique platform features on Windows.</p>
<p>In this blog post, we will dive a little deeper into the technology, walk through some sample code, and show how React Native WinRT is already in use today.</p>
<p>The <a href="https://github.com/microsoft/react-native-winrt">React Native WinRT repo</a> is now public, and a preview is available for developers to get started!</p>
<!--truncate-->
<h2><a class="anchor" aria-hidden="true" id="introducing-react-native-winrt-preview"></a><a href="#introducing-react-native-winrt-preview" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introducing React Native WinRT (Preview)</h2>
<p>Since React Native for Windows apps are truly native, they have access to the underlying native Windows Runtime (WinRT) platform. In the past, developers needed to write a native module in C++ or C# to access these WinRT APIs. With React Native WinRT, it is now possible to <strong>access the full set of Windows Runtime APIs directly from JavaScript</strong> – no native code required!</p>
<p>React Native WinRT is a tool that takes a Windows Metadata (WinMD) file and produces a React Native turbo module from it, so WinRT APIs can be accessed from JavaScript or TypeScript. The tool itself is distributed as a NuGet package, <a href="https://www.nuget.org/packages/Microsoft.ReactNative.WinRT">Microsoft.ReactNative.WinRT</a>, and is available for any currently supported versions of React Native for Windows. As of this post, this includes support for versions 0.64 up to 0.67. React Native WinRT enables easier consumption of both public Windows platform APIs as well as existing 3rd party WinRT components.</p>
<p>The React Native WinRT project was motivated by our goal to make Windows development easier and more natural across various programming languages through language projections — other existing projects under the same umbrella include <a href="http://aka.ms/cswinrt">C#/WinRT</a>, <a href="http://aka.ms/cppwinrt">C++/WinRT</a>, and <a href="https://docs.microsoft.com/windows/dev-environment/rust/rust-for-windows">Rust for Windows</a>.</p>
<p>The React Native WinRT repo includes developer <a href="https://github.com/microsoft/react-native-winrt/blob/main/docs/USAGE.md">usage documentation</a> and a <a href="https://github.com/microsoft/react-native-winrt/tree/main/samples/RNWinRTTestApp">sample app</a> that showcases calling various WinRT APIs provided by the <a href="https://developer.microsoft.com/windows/downloads/windows-sdk/">Windows SDK</a>. The sample demonstrates how to incorporate Windows platform features such as push notifications, file storage, diagnostic logging, and jump list APIs into your React Native for Windows app.</p>
<h2><a class="anchor" aria-hidden="true" id="example-adding-toast-notifications-with-react-native-winrt"></a><a href="#example-adding-toast-notifications-with-react-native-winrt" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example: Adding Toast Notifications with React Native WinRT</h2>
<p>One of the features the sample demonstrates is the Windows toast notification APIs. In a previous blog post, we showed how to <a href="https://microsoft.github.io/react-native-windows/blog/2021/06/30/notifications">Add toast notifications to your React Native for Windows application</a>. This involved writing a native module in C++ to call the native toast notification APIs and using the <code>JSValue</code> APIs to inspect values sent between the JavaScript side to the native module. Now with React Native WinRT, we can call the Toast notification APIs directly and naturally from JavaScript. Let’s walk through the steps to add toast notifications to your existing app. These steps are also in the developer usage documentation.</p>
<p>First, download the WinRTTurboModule.zip file from the react-native-winrt <a href="https://github.com/microsoft/react-native-winrt/releases">GitHub releases</a> page for the version of React Native for Windows version your app is using. When you unzip the file, you will see a directory containing the <strong>WinRTTurboModule</strong> project files and a file named <code>WinRTTurboModule.js</code>.</p>
<p>Copy the <strong>WinRTTurboModule</strong> directory to your React Native for Windows application under the <code>windows</code> folder. Then, add the <strong>WinRTTurboModule</strong> project to your solution. We recommend using Visual Studio for these steps. Next, specify the WinRT namespaces you want to project using the <code>RnWinRTParameters</code> property in <strong>ExperimentalFeatures.props</strong>:</p>
<pre><code class="hljs css language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">PropertyGroup</span> <span class="hljs-attr">Label</span>=<span class="hljs-string">"React Native WinRT properties"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">RnWinRTParameters</span>&gt;</span>
    -include Windows.UI.Notifications 
    -include Windows.Data.Xml.Dom
  <span class="hljs-tag">&lt;/<span class="hljs-name">RnWinRTParameters</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">PropertyGroup</span>&gt;</span>
</code></pre>
<p>Now you can build the <strong>WinRTTurboModule</strong> project to generate the React Native module containing these types.</p>
<p>To consume these types from your React Native Windows application, you will need to make the following modifications to reference the <strong>WinRTTurboModule</strong> project and load up the module:</p>
<ul>
<li>Add a project reference from your React Native for Windows app to the <strong>WinRTTurboModule</strong> project.</li>
<li>Include the <strong>WinRTTurboModule</strong> header in your React Native for Windows app’s pch.h file:
<pre><code class="hljs css language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;winrt/WinRTTurboModule.h></span></span>
</code></pre></li>
<li>Register the module in your React Native for Windows app in App.cpp, inside the App constructor:
<pre><code class="hljs css language-cpp"><span class="token function">PackageProviders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>winrt<span class="token double-colon punctuation">::</span><span class="token class-name">WinRTTurboModule</span><span class="token double-colon punctuation">::</span><span class="token function">ReactPackageProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
<li>Load and initialize the module in your JavaScript code. Copy the <strong>WinRTTurboModule.js</strong> file from the downloaded zip file and place it under the main directory for your application (next to index.js):
<pre><code class="hljs css language-javascript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> TurboModuleRegistry <span class="token keyword">from</span> <span class="token string">'react-native/Libraries/TurboModule/TurboModuleRegistry'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> module <span class="token operator">=</span> TurboModuleRegistry<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'WinRTTurboModule'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    module<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> module<span class="token punctuation">;</span>
</code></pre>
Then, add the following import statement in your index.js file before the App import statement:
<pre><code class="hljs css language-javascript">    <span class="token keyword">import</span> <span class="token string">'./WinRTTurboModule'</span><span class="token punctuation">;</span>
    …
    <span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span><span class="token punctuation">;</span>
</code></pre></li>
</ul>
<p>After rebuilding and running your React Native for Windows app, you will now be able to call the Notifications and XML APIs directly from your JavaScript (or TypeScript) code. Below is an example of how to do so in your App.js file.</p>
<p>First, implement the <code>showNotification</code> and <code>fillXmlElements</code> functions, which pops the toast notification and iterates through the key/value pairs for customizing the toast notification.</p>
<p>If you compare the code below to the <a href="https://microsoft.github.io/react-native-windows/blog/2021/06/30/notifications">previous blog post</a> which implements toast notifications using native C++ code, you will notice that the implementation using React Native WinRT is now <strong>entirely in JavaScript</strong> and no longer requires any manual conversions of WinRT types.</p>
<pre><code class="hljs css language-javascript"><span class="token keyword">const</span> Notifications <span class="token operator">=</span> Windows<span class="token punctuation">.</span><span class="token constant">UI</span><span class="token punctuation">.</span>Notifications<span class="token punctuation">;</span>
<span class="token keyword">const</span> ToastTemplateType <span class="token operator">=</span> Notifications<span class="token punctuation">.</span>ToastTemplateType<span class="token punctuation">;</span>
<span class="token keyword">const</span> ToastNotificationManager <span class="token operator">=</span> Notifications<span class="token punctuation">.</span>ToastNotificationManager<span class="token punctuation">;</span>
<span class="token keyword">const</span> ToastNotification <span class="token operator">=</span> Notifications<span class="token punctuation">.</span>ToastNotification<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">showNotification</span><span class="token punctuation">(</span><span class="token parameter">notification</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> type <span class="token operator">=</span> ToastTemplateType<span class="token punctuation">.</span>toastText01<span class="token punctuation">;</span>

  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>notification<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    obj<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span> <span class="token operator">=</span> notification<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    obj <span class="token operator">=</span> notification<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>template <span class="token operator">!=</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    type <span class="token operator">=</span> obj<span class="token punctuation">.</span>template<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> xml <span class="token operator">=</span> ToastNotificationManager<span class="token punctuation">.</span><span class="token function">getTemplateContent</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> tagName <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> xmlElements <span class="token operator">=</span> xml<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span>tagName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> obj<span class="token punctuation">[</span>tagName<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fillXmlElements</span><span class="token punctuation">(</span>xml<span class="token punctuation">,</span> xmlElements<span class="token punctuation">,</span> <span class="token punctuation">[</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fillXmlElements</span><span class="token punctuation">(</span>xml<span class="token punctuation">,</span> xmlElements<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fillXmlElements</span><span class="token punctuation">(</span>xml<span class="token punctuation">,</span> xmlElements<span class="token punctuation">,</span> <span class="token punctuation">[</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> toast <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ToastNotification</span><span class="token punctuation">(</span>xml<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ToastNotificationManager<span class="token punctuation">.</span><span class="token function">createToastNotifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>toast<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">fillXmlElements</span><span class="token punctuation">(</span><span class="token parameter">xml<span class="token punctuation">,</span> xmlElements<span class="token punctuation">,</span> arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> arrValue <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> node <span class="token operator">=</span> xmlElements<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>arrValue<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      node<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>xml<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span>arrValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>arrValue<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> attrName <span class="token keyword">in</span> arrValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> attr <span class="token operator">=</span> node<span class="token punctuation">.</span>attributes<span class="token punctuation">.</span><span class="token function">getNamedItem</span><span class="token punctuation">(</span>attrName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>attr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          attr <span class="token operator">=</span> xml<span class="token punctuation">.</span><span class="token function">createAttribute</span><span class="token punctuation">(</span>attrName<span class="token punctuation">)</span><span class="token punctuation">;</span>
          node<span class="token punctuation">.</span>attributes<span class="token punctuation">.</span><span class="token function">setNamedItem</span><span class="token punctuation">(</span>attr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        attr<span class="token punctuation">.</span>nodeValue <span class="token operator">=</span> arrValue<span class="token punctuation">[</span>attrName<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Now that the functions have been implemented to parse and display a toast notification, you can add a UI component that calls the showNotification function. When specifying the template attribute, you can also now directly access the <code>ToastTemplateType</code> object in JavaScript.</p>
<pre><code class="hljs css language-jsx">  <span class="token keyword">import</span> <span class="token punctuation">{</span>
      Pressable<span class="token punctuation">,</span>
  <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-native'</span><span class="token punctuation">;</span>
  <span class="token comment">// …</span>
      <span class="token operator">&lt;</span>Pressable onPress<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
                  <span class="token function">showNotification</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">template</span><span class="token operator">:</span> Windows<span class="token punctuation">.</span><span class="token constant">UI</span><span class="token punctuation">.</span>Notifications<span class="token punctuation">.</span>ToastTemplateType<span class="token punctuation">.</span>toastImageAndText01<span class="token punctuation">,</span>
                  <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"hello world"</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token literal-property property">src</span><span class="token operator">:</span> <span class="token string">"https://microsoft.github.io/react-native-windows/img/header_logo.svg"</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">alt</span><span class="token operator">:</span> <span class="token string">"React logo"</span><span class="token punctuation">,</span>
                  <span class="token punctuation">}</span>
                  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Text</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>sectionDescriptionButtonText<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Click to send a toast!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Text</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Pressable</span></span><span class="token punctuation">></span></span> 
</code></pre>
<p>You can now build and run your React Native for Windows app to pop a toast notification!</p>
<p><img src="/react-native-windows/blog/assets/toast-rnwinrt.png" alt="A Windows toast notification triggered by a React Native for Windows app using React Native WinRT"></p>
<p>For more details on the steps above, look at our <a href="https://github.com/microsoft/react-native-winrt/blob/main/docs/USAGE.md">usage documentation</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="react-native-winrt-in-action"></a><a href="#react-native-winrt-in-action" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React Native WinRT in action</h2>
<p>React Native WinRT is already being used today — we have worked with the Settings and React Native for Windows teams to leverage this technology in building the new “Your Microsoft Account” page in the Windows 11 Settings app. Instead of needing to hand-author native modules in C++, the &quot;Your Microsoft Account” page takes advantage of React Native WinRT to optimize their implementation and access the full set of Windows Runtime APIs directly from JavaScript!</p>
<p>To read more about this new experience in Windows, check out the blog post on <a href="https://aka.ms/rnwsettingsblog">React Native for Windows is helping Settings improve more quickly.</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="wrap-up"></a><a href="#wrap-up" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wrap-up</h2>
<p>Get started today by adding native Windows functionality to your React Native for Windows apps. Check out the React Native WinRT Github repo – we encourage you to try it out and give us your feedback.</p>
<p>If you’re interested in getting started with React Native for Windows, check out our website at <a href="https://aka.ms/reactnative">aka.ms/reactnative</a>.</p>
<p>You can also follow us on Twitter <a href="https://twitter.com/reactnativemsft">@ReactNativeMSFT</a> to keep up to date on news, feature roadmaps, and more.</p>
</span></div></div><div class="blogSocialSection"></div></div><div class="blog-recent"><a class="button" href="/react-native-windows/blog/">Recent Posts</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#introducing-react-native-winrt-preview">Introducing React Native WinRT (Preview)</a></li><li><a href="#example-adding-toast-notifications-with-react-native-winrt">Example: Adding Toast Notifications with React Native WinRT</a></li><li><a href="#react-native-winrt-in-action">React Native WinRT in action</a></li><li><a href="#wrap-up">Wrap-up</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><div><h5>React Native Docs</h5><a href="https://reactnative.dev/docs/getting-started">Getting Started</a><a href="https://reactnative.dev/docs/tutorial">Tutorial</a><a href="https://reactnative.dev/docs/components-and-apis">Components and APIs</a><a href="https://reactnative.dev/docs/more-resources">More Resources</a></div><div><h5>React Native for Windows + macOS Docs</h5><div style="color:white;font-weight:500;font-size:16px"><a href="/react-native-windows/docs/getting-started">Get Started with Windows</a></div><div style="color:white;font-weight:500;font-size:16px"><a href="/react-native-windows/docs/rnm-getting-started"> Get Started with macOS</a></div><a href="/react-native-windows/docs/parity-status">React Native Windows Components and APIs</a><a href="/react-native-windows/docs/native-modules">Native Modules</a><a href="/react-native-windows/docs/view-managers">Native UI Components</a></div><div><h5>Connect With Us On</h5><a href="https://devblogs.microsoft.com/react-native/">Blog</a><a href="https://twitter.com/ReactNativeMSFT" target="_blank">Twitter</a><a href="https://github.com/microsoft/react-native-windows" target="_blank">GitHub</a><a href="https://github.com/microsoft/react-native-windows-samples/tree/main/samples" target="_blank">Samples</a></div></section></footer></div></body></html>